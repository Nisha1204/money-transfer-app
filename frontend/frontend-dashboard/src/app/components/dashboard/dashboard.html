<mat-toolbar class="hero">
  <span class="toolbar-title">
    <mat-icon>account_balance</mat-icon>
    MONEY TRANSFER APP
  </span>
  <span class="spacer"></span>
  <button mat-button (click)="refreshData()">
    <mat-icon>refresh</mat-icon>
    Refresh
  </button>
  <button mat-button (click)="logout()">
    <mat-icon>logout</mat-icon>
    Logout
  </button>
</mat-toolbar>

<div class="dashboard-container">
  <div class="loading-container" *ngIf="loading">
    <mat-spinner></mat-spinner>
    <p>Loading your accounts...</p>
  </div>

  <mat-card class="error-card" *ngIf="error && !loading">
    <mat-card-content>
      <div class="error-content">
        <mat-icon color="warn">error</mat-icon>
        <p>{{ error }}</p>
      </div>
      <button mat-raised-button color="primary" (click)="refreshData()">
        Try Again
      </button>
    </mat-card-content>
  </mat-card>

  <div class="dashboard-content" *ngIf="!loading && !error && accounts.length > 0">
    
    <mat-card class="welcome-card">
      <mat-card-content>
        <h1 class="welcome-message">
          <mat-icon class="welcome-icon">waving_hand</mat-icon>
          Welcome, {{ accounts[0].holderName }}!
        </h1>
        <p class="welcome-subtitle">You have {{ accounts.length }} active account(s)</p>
      </mat-card-content>
    </mat-card>

    <mat-tab-group 
      (selectedIndexChange)="onTabChange($event)" 
      backgroundColor="primary" 
      class="account-tabs">
      
      <mat-tab *ngFor="let acc of accounts">
        <ng-template mat-tab-label>
          <mat-icon class="tab-icon">account_balance</mat-icon>
          Account #{{ acc.id }}
        </ng-template>
      </mat-tab>
    </mat-tab-group>

    <div class="selected-account-view" *ngIf="selectedAccount">
      <mat-card class="balance-card">
        <mat-card-header>
          <mat-icon mat-card-avatar class="balance-icon">account_balance_wallet</mat-icon>
          <mat-card-title>{{ selectedAccount.holderName }}'s Balance</mat-card-title>
          <mat-card-subtitle>Status: {{ selectedAccount.status }}</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <div class="balance-amount">
            â‚¹{{ selectedAccount.balance | number:'1.2-2' }}
          </div>
          <p class="last-updated" *ngIf="selectedAccount.updatedAt">
            Last Updated: {{ selectedAccount.updatedAt | date:'medium' }}
          </p>
        </mat-card-content>
      </mat-card>

      <div class="action-grid">
        <mat-card class="action-card" (click)="viewAccountDetails(selectedAccount.id)">
          <mat-card-content>
            <mat-icon color="primary">account_circle</mat-icon>
            <h3>Account Details</h3>
          </mat-card-content>
        </mat-card>

        <mat-card class="action-card" (click)="viewBalance(selectedAccount.id)">
          <mat-card-content>
            <mat-icon color="accent">payments</mat-icon>
            <h3>Balance Inquiry</h3>
          </mat-card-content>
        </mat-card>

        <mat-card class="action-card" (click)="doTransfer(selectedAccount.id)">
          <mat-card-content>
            <mat-icon>send</mat-icon>
            <h3>Transfer Money</h3>
          </mat-card-content>
        </mat-card>

        <mat-card class="action-card" (click)="viewTransactions(selectedAccount.id)">
          <mat-card-content>
            <mat-icon>history</mat-icon>
            <h3>Transaction History</h3>
          </mat-card-content>
        </mat-card>
      </div>
    </div>
  </div>

  <div class="empty-state" *ngIf="!loading && !error && accounts.length === 0">
    <mat-icon>info</mat-icon>
    <p>You don't have any accounts linked yet.</p>
    <button mat-raised-button color="primary">Open New Account</button>
  </div>
</div>