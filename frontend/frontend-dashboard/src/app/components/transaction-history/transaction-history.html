<!-- <mat-toolbar color="primary" class="mat-elevation-z4">
  <button mat-icon-button (click)="goBack()">
    <mat-icon>arrow_back</mat-icon>
  </button>
  <span>Transaction History - Account #{{currentAccountId}}</span>
</mat-toolbar>

<div class="container" style="padding: 20px;">
  <div *ngIf="transactions.length > 0; else empty" class="mat-elevation-z8">
    <table mat-table [dataSource]="transactions">

      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef> Transaction Ref </th>
        <td mat-cell *matCellDef="let t" style="font-size: 11px; color: #666;"> 
          {{ t.id.split('-')[1] }}... 
        </td>
      </ng-container>

      <ng-container matColumnDef="date">
        <th mat-header-cell *matHeaderCellDef> Date </th>
        <td mat-cell *matCellDef="let t"> {{ t.createdOn | date:'medium' }} </td>
      </ng-container>

      <ng-container matColumnDef="description">
        <th mat-header-cell *matHeaderCellDef> Description </th>
        <td mat-cell *matCellDef="let t">
          <div style="display: flex; align-items: center;">
            <mat-icon [style.color]="isSent(t) ? '#f44336' : '#4caf50'" style="margin-right: 10px;">
              {{ isSent(t) ? 'outbox' : 'move_to_inbox' }}
            </mat-icon>
            <span>
              {{ isSent(t) ? 'Transfer to ID: ' + t.toAccountId : 'Received from ID: ' + t.fromAccountId }}
            </span>
          </div>
        </td>
      </ng-container>

      <ng-container matColumnDef="amount">
        <th mat-header-cell *matHeaderCellDef> Amount </th>
        <td mat-cell *matCellDef="let t" [style.color]="isSent(t) ? '#f44336' : '#4caf50'" style="font-weight: bold;">
          {{ isSent(t) ? '-' : '+' }} {{ t.amount | currency:'INR' }}
        </td>
      </ng-container>

      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef> Status </th>
        <td mat-cell *matCellDef="let t">
          <span [style.color]="t.status === 'SUCCESS' ? '#4caf50' : '#f44336'" 
                style="font-weight: 500; font-size: 12px;">
            ‚óè {{ t.status }}
          </span>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </div>

  <ng-template #empty>
    <div style="text-align: center; padding: 50px;">
      <mat-icon style="font-size: 64px; height: 64px; width: 64px; color: #ddd;">receipt_long</mat-icon>
      <h2 style="color: #999;">No transactions found for this account.</h2>
    </div>
  </ng-template>
</div> -->

<mat-toolbar class="header-toolbar">
  <button mat-icon-button (click)="goBack()" matTooltip="Back to Dashboard">
    <mat-icon>arrow_back</mat-icon>
  </button>
  <span class="title">History <span class="acc-badge">#{{currentAccountId}}</span></span>
  <span class="spacer"></span>
  <button mat-icon-button (click)="loadTransactions(currentAccountId!)" *ngIf="currentAccountId">
    <mat-icon>sync</mat-icon>
  </button>
</mat-toolbar>

<div class="history-container">
  <div *ngIf="transactions.length > 0; else empty" class="table-card">
    <table mat-table [dataSource]="transactions" class="modern-table">

      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef> Reference </th>
        <td mat-cell *matCellDef="let t" class="ref-cell"> 
          #{{ t.id.split('-')[1] }} 
        </td>
      </ng-container>

      <ng-container matColumnDef="date">
        <th mat-header-cell *matHeaderCellDef> Date & Time </th>
        <td mat-cell *matCellDef="let t">
          <div class="date-stack">
            <span class="date">{{ t.createdOn | date:'mediumDate' }}</span>
            <span class="time">{{ t.createdOn | date:'shortTime' }}</span>
          </div>
        </td>
      </ng-container>

      <ng-container matColumnDef="description">
        <th mat-header-cell *matHeaderCellDef> Description </th>
        <td mat-cell *matCellDef="let t">
          <div class="desc-wrapper">
            <div class="type-icon" [ngClass]="isSent(t) ? 'sent' : 'received'">
              <mat-icon>{{ isSent(t) ? 'arrow_upward' : 'arrow_downward' }}</mat-icon>
            </div>
            <div class="desc-text">
              <strong>{{ isSent(t) ? 'Transfer Sent' : 'Transfer Received' }}</strong>
              <span>{{ isSent(t) ? 'To ID: ' + t.toAccountId : 'From ID: ' + t.fromAccountId }}</span>
            </div>
          </div>
        </td>
      </ng-container>

      <ng-container matColumnDef="amount">
        <th mat-header-cell *matHeaderCellDef> Amount </th>
        <td mat-cell *matCellDef="let t" 
            class="amount-cell" 
            [ngClass]="isSent(t) ? 'debit' : 'credit'">
          {{ isSent(t) ? '-' : '+' }}{{ t.amount | currency:'INR' }}
        </td>
      </ng-container>

      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef> Status </th>
        <td mat-cell *matCellDef="let t">
          <span class="status-pill" [attr.data-status]="t.status">
            {{ t.status }}
          </span>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </div>

  <ng-template #empty>
    <div class="empty-state">
      <div class="empty-icon-box">
        <mat-icon>history_toggle_off</mat-icon>
      </div>
      <h2>No Transactions Yet</h2>
      <p>Your transaction activity will appear here once you start moving funds.</p>
      <button mat-flat-button color="primary" (click)="goBack()">Go to Dashboard</button>
    </div>
  </ng-template>
</div>